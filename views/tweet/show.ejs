<!DOCTYPE html>
<html lang="en">
    <%- include('../partials/_head.ejs', {page: "Dashboard"})%>
<body>
    <div class="container-fluid" id="tweetIndex">    
        <div class="row">
        <%- include('../partials/nav/_nav.ejs', {image: user.avatar, name: user.username})%>
            <section class="col" id="tweetSection">
                <article class="tweet">
                    <div class="card mb-0 rounded-0 border-top-0">
                        <div class="card-body d-flex flex-row">
                          <img src="<%= tweet.user.avatar%>" id="avatar" class="rounded-circle">
                          <a href="/tweets/<%= tweet.id %>"><h5 class="card-title"><%= tweet.user.username %>
                            <% const now = new Date(); %>
                            <% const oneDay = 1000 * 60 * 60 * 24; %>
                            <% let timeDifference = now.getTime() - tweet.date.getTime(); %>
                            <% timeDifference = Math.round(timeDifference/(1000 * 60));%>
                            <% if (timeDifference <= 59) {
                                let time = timeDifference + "m" %>
                            <% } else if (timeDifference > 60) { %>
                            <%      let time = timeDifference/(1000 * 60 * 60); %>   
                            <% } else if (timeDifference > 1440 ) %>
                            <%      let time = tweet.date.toLocaleDateString('en-US', { month: 'short', day: 'numeric' }); %>
                            <span id="time"><%= time %></span></h5>
                          <p class="card-text"><%= tweet.content%></p>
                          </a>
                          <div class="d-flex flex-column buttonDiv">
                            <form action="/tweets/<%= tweet.id %>?_method=DELETE" method="POST" class="align-self-end"><button class="btn btn-light buttons fw-bold border-0" type="submit"><i class="fas fa-ellipsis-h"></i></button></a>
                            </form>
                            <a href="/comment" class="align-self-end" id="commentLink"><button class="btn btn-light buttons fw-bold border-0"><i class="far fa-comment"></i></button></a>
                          </div>
                        </div>
                      </div>
                </article>

                <article>
                    <div class="card rounded-0">
                        <div class="card-body d-flex flex-column">
                            <h4 class="card-title fw-bold mb-3"></h4>
                            
                            <div class="d-flex justify-content-around">
                            <img src="<%= user.avatar %>" class="rounded-circle">
                            <form action="/comments" method="POST" class="d-flex flex-column">
                                <div class="mb-3">
                                    <textarea class="form-control" id="commentContent" name="content" placeholder="Tweet your reply" rows="3" cols="65" ></textarea>   
                                </div>
                            </div>    
                            <input type="submit" value="Reply" class="btn btn-primary ml-auto align-self-end"></input>
                            <input type="hidden" name="tweet" value="<%= tweet._id %>"/>
                            </form>
                        </div>
                    </div>
                </article>
                

            </section>
            <section class="col-3">
                    <div class="d-flex flex-column align-items-stretchbg-white">
                        <a href="/" class="d-flex align-items-center p-3 link-dark text-decoration-none border-bottom">
                        <svg class="bi me-2" width="30" height="24"><use xlink:href="#bootstrap"></use></svg>
                        <span class="fs-5 fw-semibold">List group</span>
                        </a>
                        <div class="list-group list-group-flush border-bottom scrollarea">
                        <a href="#" class="list-group-item list-group-item-action active py-3 lh-tight" aria-current="true">
                            <div class="d-flex w-100 align-items-center justify-content-between">
                            <strong class="mb-1">List group item heading</strong>
                            <small>Wed</small>
                            </div>
                            <div class="col-10 mb-1 small">Some placeholder content in a paragraph below the heading and date.</div>
                        </a>
                        <a href="#" class="list-group-item list-group-item-action py-3 lh-tight">
                            <div class="d-flex w-100 align-items-center justify-content-between">
                            <strong class="mb-1">List group item heading</strong>
                            <small class="text-muted">Tues</small>
                            </div>
                            <div class="col-10 mb-1 small">Some placeholder content in a paragraph below the heading and date.</div>
                        </a>
                        </div>
                    </div>
                </section>
            </div>
      </div>
    
</body>
</html>